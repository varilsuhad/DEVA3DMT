% © 2020–2025 Deniz Varılsüha — Non-commercial research use only. See LICENSE.
% Contact: deniz.varilsuha@itu.edu.tr
function [bak1,bak2] = Pmerge3DMTHYBS3MULTFF3mex(PC,veri,ok,vec1,vec2,set)

e1=gpuArray(veri.e1);
e2=gpuArray(veri.e2);
f=veri.f;

 if(set.MergeOnCPU==0)

 [bak1,bak2]=PmergebothCF(double(f),int32(ok),PC.m,e1,e2,(complex(vec1)),(complex(vec2)),PC.WMr,PC.WMc,PC.WMv,...
 PC.AM1r,PC.AM1c,PC.AM1v,PC.AM2r,PC.AM2c,PC.AM2v,PC.AM3r,PC.AM3c,PC.AM3v,PC.AM4r,PC.AM4c,PC.AM4v, ...
 PC.AD1r,PC.AD1c,PC.AD1v,PC.AD2r,PC.AD2c,PC.AD2v,PC.AD3r,PC.AD3c,PC.AD3v,PC.AD4r,PC.AD4c,PC.AD4v,...
 PC.AD5r,PC.AD5c,PC.AD5v,PC.AD6r,PC.AD6c,PC.AD6v,PC.AD7r,PC.AD7c,PC.AD7v,PC.AD8r,PC.AD8c,PC.AD8v,...
 PC.AL1r,PC.AL1c,PC.AL1v,PC.AL2r,PC.AL2c,PC.AL2v,PC.AL3r,PC.AL3c,PC.AL3v,PC.AL4r,PC.AL4c,PC.AL4v,...
 PC.AL5r,PC.AL5c,PC.AL5v,PC.AL6r,PC.AL6c,PC.AL6v,PC.AL7r,PC.AL7c,PC.AL7v,PC.AL8r,PC.AL8c,PC.AL8v,...
 PC.BM1r,PC.BM1c,PC.BM1v,PC.BM2r,PC.BM2c,PC.BM2v,PC.BM3r,PC.BM3c,PC.BM3v,PC.BM4r,PC.BM4c,PC.BM4v,...
 PC.BD1r,PC.BD1c,PC.BD1v,PC.BD2r,PC.BD2c,PC.BD2v,PC.BD3r,PC.BD3c,PC.BD3v,PC.BD4r,PC.BD4c,PC.BD4v,...
 PC.BD5r,PC.BD5c,PC.BD5v,PC.BD6r,PC.BD6c,PC.BD6v, PC.BD7r,PC.BD7c,PC.BD7v,PC.BD8r,PC.BD8c,PC.BD8v,...
 PC.BL1r,PC.BL1c,PC.BL1v,PC.BL2r,PC.BL2c,PC.BL2v,PC.BL3r,PC.BL3c,PC.BL3v,PC.BL4r,PC.BL4c,PC.BL4v,...
 PC.BL5r,PC.BL5c,PC.BL5v,PC.BL6r,PC.BL6c,PC.BL6v,PC.BL7r,PC.BL7c,PC.BL7v,PC.BL8r,PC.BL8c,PC.BL8v,...
 PC.W1r,PC.W1c,PC.W1v,PC.W2r,PC.W2c,PC.W2v,PC.W3r,PC.W3c,PC.W3v,PC.W4r,PC.W4c,PC.W4v,...
 PC.W5r,PC.W5c,PC.W5v,PC.W6r,PC.W6c,PC.W6v,PC.W7r,PC.W7c,PC.W7v,PC.W8r,PC.W8c,PC.W8v);

else
[ bak1,bak2 ]=Pmerge3DMTHYBS3MULTF3(PC,veri,ok,vec1,vec2);
end

end
